{
  "type": "Program",
  "nodes": [
    {
      "type": "Node",
      "id": "start",
      "statements": [
        {
          "type": "Say",
          "text": "Welcome to the adventure!",
          "interpolations": [],
          "line": 3,
          "column": 3
        },
        {
          "type": "Say",
          "text": "You have #{...} gold and #{...} HP.",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "gold",
                "line": 4,
                "column": 19,
                "endColumn": 24
              },
              "start": 9,
              "end": 9
            },
            {
              "expression": {
                "type": "Variable",
                "name": "health",
                "line": 4,
                "column": 37,
                "endColumn": 44
              },
              "start": 25,
              "end": 25
            }
          ],
          "line": 4,
          "column": 3
        },
        {
          "type": "Assignment",
          "variable": "visited_start",
          "operator": "=",
          "value": {
            "type": "Literal",
            "value": true,
            "line": 6,
            "column": 20,
            "endColumn": 24
          },
          "line": 6,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "visit_count",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "+",
            "left": {
              "type": "Variable",
              "name": "visit_count",
              "line": 7,
              "column": 18,
              "endColumn": 30
            },
            "right": {
              "type": "Literal",
              "value": 1,
              "line": 7,
              "column": 33,
              "endColumn": null
            },
            "line": 7,
            "column": 31,
            "endColumn": 32
          },
          "line": 7,
          "column": 4
        },
        {
          "type": "Choice",
          "text": "Go to shop",
          "target": "shop",
          "line": 9,
          "column": 24,
          "textLine": 9,
          "textColumn": 11
        },
        {
          "type": "Choice",
          "text": "Go to forest",
          "target": "forest",
          "line": 10,
          "column": 26,
          "textLine": 10,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "right": {
              "type": "Literal",
              "value": 5,
              "line": 10,
              "column": 49,
              "endColumn": null
            },
            "left": {
              "type": "Variable",
              "name": "level",
              "line": 10,
              "column": 39,
              "endColumn": 45
            },
            "operator": ">=",
            "line": 10,
            "column": 46,
            "endColumn": 48
          }
        },
        {
          "type": "Choice",
          "text": "Rest at inn",
          "target": "inn",
          "line": 11,
          "column": 25,
          "textLine": 11,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "operator": "&&",
            "left": {
              "type": "BinaryOp",
              "right": {
                "type": "Literal",
                "value": 20,
                "line": 11,
                "column": 44,
                "endColumn": null
              },
              "left": {
                "type": "Variable",
                "name": "gold",
                "line": 11,
                "column": 35,
                "endColumn": 40
              },
              "operator": ">=",
              "line": 11,
              "column": 41,
              "endColumn": 43
            },
            "right": {
              "type": "BinaryOp",
              "right": {
                "type": "Literal",
                "value": 100,
                "line": 11,
                "column": 60,
                "endColumn": null
              },
              "left": {
                "type": "Variable",
                "name": "health",
                "line": 11,
                "column": 50,
                "endColumn": 57
              },
              "operator": "<",
              "line": 11,
              "column": 58,
              "endColumn": 59
            },
            "line": 11,
            "column": 47,
            "endColumn": 49
          }
        },
        {
          "type": "Choice",
          "text": "Check inventory",
          "target": "inventory",
          "line": 12,
          "column": 29,
          "textLine": 12,
          "textColumn": 11,
          "condition": {
            "type": "UnaryOp",
            "operator": "!",
            "operand": {
              "type": "Variable",
              "name": "inventory_empty",
              "line": 12,
              "column": 46,
              "endColumn": 62
            },
            "line": 12,
            "column": 45,
            "endColumn": 46
          }
        },
        {
          "type": "Choice",
          "text": "Quit",
          "target": "ending",
          "line": 13,
          "column": 18,
          "textLine": 13,
          "textColumn": 11
        }
      ],
      "line": 2,
      "column": 7
    },
    {
      "type": "Node",
      "id": "shop",
      "statements": [
        {
          "type": "Say",
          "text": "Welcome to my shop!",
          "interpolations": [],
          "line": 17,
          "column": 3
        },
        {
          "type": "Say",
          "text": "I have potions for 50 gold.",
          "interpolations": [],
          "line": 18,
          "column": 3
        },
        {
          "type": "Choice",
          "text": "Buy potion",
          "target": "buy_potion",
          "line": 20,
          "column": 24,
          "textLine": 20,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "right": {
              "type": "Literal",
              "value": 50,
              "line": 20,
              "column": 50,
              "endColumn": null
            },
            "left": {
              "type": "Variable",
              "name": "gold",
              "line": 20,
              "column": 41,
              "endColumn": 46
            },
            "operator": ">=",
            "line": 20,
            "column": 47,
            "endColumn": 49
          }
        },
        {
          "type": "Choice",
          "text": "Sell items",
          "target": "sell_items",
          "line": 21,
          "column": 24,
          "textLine": 21,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "right": {
              "type": "Literal",
              "value": true,
              "line": 21,
              "column": 55,
              "endColumn": 59
            },
            "left": {
              "type": "Variable",
              "name": "has_items",
              "line": 21,
              "column": 41,
              "endColumn": 51
            },
            "operator": "==",
            "line": 21,
            "column": 52,
            "endColumn": 54
          }
        },
        {
          "type": "Choice",
          "text": "Leave",
          "target": "start",
          "line": 22,
          "column": 19,
          "textLine": 22,
          "textColumn": 11
        }
      ],
      "line": 16,
      "column": 6
    },
    {
      "type": "Node",
      "id": "empty",
      "statements": [],
      "line": 25,
      "column": 6
    },
    {
      "type": "Node",
      "id": "buy_potion",
      "statements": [
        {
          "type": "Assignment",
          "variable": "gold",
          "operator": "-=",
          "value": {
            "type": "Literal",
            "value": 50,
            "line": 29,
            "column": 12,
            "endColumn": null
          },
          "line": 29,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "health",
          "operator": "+=",
          "value": {
            "type": "Literal",
            "value": 30,
            "line": 30,
            "column": 14,
            "endColumn": null
          },
          "line": 30,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "potions",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "+",
            "left": {
              "type": "Variable",
              "name": "potions",
              "line": 31,
              "column": 14,
              "endColumn": 22
            },
            "right": {
              "type": "Literal",
              "value": 1,
              "line": 31,
              "column": 25,
              "endColumn": null
            },
            "line": 31,
            "column": 23,
            "endColumn": 24
          },
          "line": 31,
          "column": 4
        },
        {
          "type": "Say",
          "text": "You bought a potion!",
          "interpolations": [],
          "line": 33,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Health restored to #{...}.",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "health",
                "line": 34,
                "column": 29,
                "endColumn": 36
              },
              "start": 19,
              "end": 19
            }
          ],
          "line": 34,
          "column": 3
        },
        {
          "type": "Goto",
          "target": "shop",
          "line": 36,
          "column": 8
        }
      ],
      "line": 28,
      "column": 6
    },
    {
      "type": "Node",
      "id": "sell_items",
      "statements": [
        {
          "type": "Assignment",
          "variable": "gold",
          "operator": "+=",
          "value": {
            "type": "FunctionCall",
            "name": "random",
            "args": [
              {
                "type": "Literal",
                "value": 10,
                "line": 40,
                "column": 19,
                "endColumn": null
              },
              {
                "type": "Literal",
                "value": 50,
                "line": 40,
                "column": 23,
                "endColumn": null
              }
            ],
            "line": 40,
            "column": 12,
            "endColumn": 26
          },
          "line": 40,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "has_items",
          "operator": "=",
          "value": {
            "type": "Literal",
            "value": false,
            "line": 41,
            "column": 16,
            "endColumn": 21
          },
          "line": 41,
          "column": 4
        },
        {
          "type": "Say",
          "text": "You sold your items for #{...} gold.",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "gold",
                "line": 43,
                "column": 34,
                "endColumn": 39
              },
              "start": 24,
              "end": 24
            }
          ],
          "line": 43,
          "column": 3
        },
        {
          "type": "Choice",
          "text": "Continue shopping",
          "target": "shop",
          "line": 45,
          "column": 31,
          "textLine": 45,
          "textColumn": 11
        },
        {
          "type": "Choice",
          "text": "Leave",
          "target": "start",
          "line": 46,
          "column": 19,
          "textLine": 46,
          "textColumn": 11
        }
      ],
      "line": 39,
      "column": 6
    },
    {
      "type": "Node",
      "id": "forest",
      "statements": [
        {
          "type": "Say",
          "text": "You enter the dark forest...",
          "interpolations": [],
          "line": 50,
          "column": 3
        },
        {
          "type": "Assignment",
          "variable": "enemy_hp",
          "operator": "=",
          "value": {
            "type": "FunctionCall",
            "name": "random",
            "args": [
              {
                "type": "Literal",
                "value": 20,
                "line": 52,
                "column": 22,
                "endColumn": null
              },
              {
                "type": "Literal",
                "value": 50,
                "line": 52,
                "column": 26,
                "endColumn": null
              }
            ],
            "line": 52,
            "column": 15,
            "endColumn": 29
          },
          "line": 52,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "damage",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "*",
            "left": {
              "type": "Variable",
              "name": "strength",
              "line": 53,
              "column": 13,
              "endColumn": 22
            },
            "right": {
              "type": "Literal",
              "value": 2,
              "line": 53,
              "column": 25,
              "endColumn": null
            },
            "line": 53,
            "column": 23,
            "endColumn": 24
          },
          "line": 53,
          "column": 4
        },
        {
          "type": "Choice",
          "text": "Attack",
          "target": "battle",
          "line": 55,
          "column": 20,
          "textLine": 55,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "right": {
              "type": "Literal",
              "value": 0,
              "line": 55,
              "column": 45,
              "endColumn": null
            },
            "left": {
              "type": "Variable",
              "name": "enemy_hp",
              "line": 55,
              "column": 33,
              "endColumn": 42
            },
            "operator": ">",
            "line": 55,
            "column": 43,
            "endColumn": 44
          }
        },
        {
          "type": "Choice",
          "text": "Run away",
          "target": "start",
          "line": 56,
          "column": 22,
          "textLine": 56,
          "textColumn": 11
        }
      ],
      "line": 49,
      "column": 6
    },
    {
      "type": "Node",
      "id": "battle",
      "statements": [
        {
          "type": "Assignment",
          "variable": "enemy_hp",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "-",
            "left": {
              "type": "Variable",
              "name": "enemy_hp",
              "line": 60,
              "column": 15,
              "endColumn": 24
            },
            "right": {
              "type": "Variable",
              "name": "damage",
              "line": 60,
              "column": 27,
              "endColumn": 34
            },
            "line": 60,
            "column": 25,
            "endColumn": 26
          },
          "line": 60,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "health",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "-",
            "left": {
              "type": "Variable",
              "name": "health",
              "line": 61,
              "column": 13,
              "endColumn": 20
            },
            "right": {
              "type": "FunctionCall",
              "name": "random",
              "args": [
                {
                  "type": "Literal",
                  "value": 5,
                  "line": 61,
                  "column": 30,
                  "endColumn": null
                },
                {
                  "type": "Literal",
                  "value": 15,
                  "line": 61,
                  "column": 33,
                  "endColumn": null
                }
              ],
              "line": 61,
              "column": 23,
              "endColumn": 36
            },
            "line": 61,
            "column": 21,
            "endColumn": 22
          },
          "line": 61,
          "column": 4
        },
        {
          "type": "Say",
          "text": "You deal #{...} damage!",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "damage",
                "line": 63,
                "column": 19,
                "endColumn": 26
              },
              "start": 9,
              "end": 9
            }
          ],
          "line": 63,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Enemy HP: #{...}",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "enemy_hp",
                "line": 64,
                "column": 20,
                "endColumn": 29
              },
              "start": 10,
              "end": 10
            }
          ],
          "line": 64,
          "column": 3
        },
        {
          "type": "Choice",
          "text": "Continue fighting",
          "target": "battle",
          "line": 66,
          "column": 31,
          "textLine": 66,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "operator": "&&",
            "left": {
              "type": "BinaryOp",
              "right": {
                "type": "Literal",
                "value": 0,
                "line": 66,
                "column": 56,
                "endColumn": null
              },
              "left": {
                "type": "Variable",
                "name": "enemy_hp",
                "line": 66,
                "column": 44,
                "endColumn": 53
              },
              "operator": ">",
              "line": 66,
              "column": 54,
              "endColumn": 55
            },
            "right": {
              "type": "BinaryOp",
              "right": {
                "type": "Literal",
                "value": 0,
                "line": 66,
                "column": 71,
                "endColumn": null
              },
              "left": {
                "type": "Variable",
                "name": "health",
                "line": 66,
                "column": 61,
                "endColumn": 68
              },
              "operator": ">",
              "line": 66,
              "column": 69,
              "endColumn": 70
            },
            "line": 66,
            "column": 58,
            "endColumn": 60
          }
        },
        {
          "type": "Choice",
          "text": "Victory!",
          "target": "victory",
          "line": 67,
          "column": 22,
          "textLine": 67,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "right": {
              "type": "Literal",
              "value": 0,
              "line": 67,
              "column": 49,
              "endColumn": null
            },
            "left": {
              "type": "Variable",
              "name": "enemy_hp",
              "line": 67,
              "column": 36,
              "endColumn": 45
            },
            "operator": "<=",
            "line": 67,
            "column": 46,
            "endColumn": 48
          }
        },
        {
          "type": "Choice",
          "text": "Defeat...",
          "target": "defeat",
          "line": 68,
          "column": 23,
          "textLine": 68,
          "textColumn": 11,
          "condition": {
            "type": "BinaryOp",
            "right": {
              "type": "Literal",
              "value": 0,
              "line": 68,
              "column": 47,
              "endColumn": null
            },
            "left": {
              "type": "Variable",
              "name": "health",
              "line": 68,
              "column": 36,
              "endColumn": 43
            },
            "operator": "<=",
            "line": 68,
            "column": 44,
            "endColumn": 46
          }
        }
      ],
      "line": 59,
      "column": 6
    },
    {
      "type": "Node",
      "id": "victory",
      "statements": [
        {
          "type": "Assignment",
          "variable": "gold",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "+",
            "left": {
              "type": "Variable",
              "name": "gold",
              "line": 72,
              "column": 11,
              "endColumn": 16
            },
            "right": {
              "type": "FunctionCall",
              "name": "random",
              "args": [
                {
                  "type": "Literal",
                  "value": 50,
                  "line": 72,
                  "column": 26,
                  "endColumn": null
                },
                {
                  "type": "Literal",
                  "value": 100,
                  "line": 72,
                  "column": 30,
                  "endColumn": null
                }
              ],
              "line": 72,
              "column": 19,
              "endColumn": 34
            },
            "line": 72,
            "column": 17,
            "endColumn": 18
          },
          "line": 72,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "xp",
          "operator": "+=",
          "value": {
            "type": "Literal",
            "value": 100,
            "line": 73,
            "column": 10,
            "endColumn": null
          },
          "line": 73,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "level",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "+",
            "left": {
              "type": "Variable",
              "name": "level",
              "line": 74,
              "column": 12,
              "endColumn": 18
            },
            "right": {
              "type": "Literal",
              "value": 1,
              "line": 74,
              "column": 21,
              "endColumn": null
            },
            "line": 74,
            "column": 19,
            "endColumn": 20
          },
          "line": 74,
          "column": 4
        },
        {
          "type": "Say",
          "text": "You won the battle!",
          "interpolations": [],
          "line": 76,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Gained #{...} gold and leveled up!",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "gold",
                "line": 77,
                "column": 17,
                "endColumn": 22
              },
              "start": 7,
              "end": 7
            }
          ],
          "line": 77,
          "column": 3
        },
        {
          "type": "Goto",
          "target": "start",
          "line": 79,
          "column": 8
        }
      ],
      "line": 71,
      "column": 6
    },
    {
      "type": "Node",
      "id": "defeat",
      "statements": [
        {
          "type": "Say",
          "text": "You were defeated...",
          "interpolations": [],
          "line": 83,
          "column": 3
        },
        {
          "type": "Assignment",
          "variable": "health",
          "operator": "=",
          "value": {
            "type": "Literal",
            "value": 100,
            "line": 84,
            "column": 13,
            "endColumn": null
          },
          "line": 84,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "gold",
          "operator": "=",
          "value": {
            "type": "BinaryOp",
            "operator": "/",
            "left": {
              "type": "Variable",
              "name": "gold",
              "line": 85,
              "column": 11,
              "endColumn": 16
            },
            "right": {
              "type": "Literal",
              "value": 2,
              "line": 85,
              "column": 19,
              "endColumn": null
            },
            "line": 85,
            "column": 17,
            "endColumn": 18
          },
          "line": 85,
          "column": 4
        },
        {
          "type": "Goto",
          "target": "start",
          "line": 87,
          "column": 8
        }
      ],
      "line": 82,
      "column": 6
    },
    {
      "type": "Node",
      "id": "inn",
      "statements": [
        {
          "type": "Assignment",
          "variable": "gold",
          "operator": "-=",
          "value": {
            "type": "Literal",
            "value": 20,
            "line": 91,
            "column": 12,
            "endColumn": null
          },
          "line": 91,
          "column": 4
        },
        {
          "type": "Assignment",
          "variable": "health",
          "operator": "=",
          "value": {
            "type": "Literal",
            "value": 100,
            "line": 92,
            "column": 13,
            "endColumn": null
          },
          "line": 92,
          "column": 4
        },
        {
          "type": "Say",
          "text": "You rest at the inn.",
          "interpolations": [],
          "line": 94,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Health fully restored!",
          "interpolations": [],
          "line": 95,
          "column": 3
        },
        {
          "type": "Goto",
          "target": "start",
          "line": 97,
          "column": 8
        }
      ],
      "line": 90,
      "column": 6
    },
    {
      "type": "Node",
      "id": "inventory",
      "statements": [
        {
          "type": "Say",
          "text": "Your inventory:",
          "interpolations": [],
          "line": 101,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Gold: #{...}",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "gold",
                "line": 102,
                "column": 16,
                "endColumn": 21
              },
              "start": 6,
              "end": 6
            }
          ],
          "line": 102,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Potions: #{...}",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "potions",
                "line": 103,
                "column": 19,
                "endColumn": 27
              },
              "start": 9,
              "end": 9
            }
          ],
          "line": 103,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Level: #{...}",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "level",
                "line": 104,
                "column": 17,
                "endColumn": 23
              },
              "start": 7,
              "end": 7
            }
          ],
          "line": 104,
          "column": 3
        },
        {
          "type": "Choice",
          "text": "Back",
          "target": "start",
          "line": 106,
          "column": 18,
          "textLine": 106,
          "textColumn": 11
        }
      ],
      "line": 100,
      "column": 6
    },
    {
      "type": "Node",
      "id": "ending",
      "statements": [
        {
          "type": "Say",
          "text": "Thanks for playing!",
          "interpolations": [],
          "line": 110,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Final stats:",
          "interpolations": [],
          "line": 111,
          "column": 3
        },
        {
          "type": "Say",
          "text": "Gold: #{...}, Level: #{...}",
          "interpolations": [
            {
              "expression": {
                "type": "Variable",
                "name": "gold",
                "line": 112,
                "column": 16,
                "endColumn": 21
              },
              "start": 6,
              "end": 6
            },
            {
              "expression": {
                "type": "Variable",
                "name": "level",
                "line": 112,
                "column": 33,
                "endColumn": 39
              },
              "start": 21,
              "end": 21
            }
          ],
          "line": 112,
          "column": 3
        }
      ],
      "line": 109,
      "column": 6
    }
  ]
}